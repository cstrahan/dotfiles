---
- name: Provision Development Environment
  hosts: all
  gather_facts: true

  pre_tasks:
    - name: Verify OS requirements
      ansible.builtin.assert:
        that:
          - ansible_os_family in ["Debian", "Darwin"]
        fail_msg: "This playbook only supports Debian/Ubuntu and macOS systems."

  roles:
    # Linux-only system tools
    - role: plocate
      when: ansible_os_family == "Debian"
    - role: bcc
      when: ansible_os_family == "Debian"
    - role: bpftrace
      when: ansible_os_family == "Debian"
    - role: neovim
      when: ansible_os_family == "Debian"
    # Cross-platform user configuration
    - role: dev_user
